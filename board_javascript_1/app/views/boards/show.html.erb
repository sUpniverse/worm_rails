<div class="container">
	<table class="table table-default">
		<tr>
			<th colspan="2"><%=@board.id%>번 글</th>
		</tr>
		<tbody>
			<tr><td>제목</td><td><%=@board.title%></td></tr>

			<tr><td>내용</td><td><%=@board.contents%></td></tr>
		</tbody>		
	</table>
		<a href="/" class="btn btn-primary">글 목록</a>
		<button type="button" class="btn btn-info" id="like">
			<i class="fas fa-thumbs-up fa-lg"></i>좋아요(<span id="like-count">0</span>)
		</button>
		<a href="/boards/<%=@board.id%>/edit" class="btn btn-warning">수정</a>
		<a href="/boards/<%=@board.id%>" data-method="delete" class="btn btn-secondary" >삭제</a>
</div>

<div class="container mt-5" >
	<div class="row">
		<div class="col-md-8">
			 <div class="page-header">
	         	<h3><small class="float-right"><%= @board.comments.all.length%>comments</small> Comments </h3>
	         </div>
			<form id="comment-form">
				<input type="text" class="form-control" id="comment">
				<button type="submit" class="btn btn-danger create-comment mt-2">댓글달기</button>
			</form>			
			<div class="comments-list" style="margin-top: 3rem">
				<% @board.comments.each do |comment| %>
            	<div class="media">                	
                	<a class="media-left" href="#">
                      <img class="align-self-center mr-3" src="#">
                    </a>

                	<div class="media-body"> 
                	  <p class="pr-1"><small><%=comment.created_at%></small></p>                       
                      <h5 class="mt-0">username</h5>
                     <%= comment.contents %>                      
                      <p><small><a href="">수정</a> - <a href="">삭제</a> - <a href="">좋아요</a></small></p>
                    </div>
                </div>
                <%end%>
            </div>
		</div>	
	</div>
</div>


<script >
	$(function() {
		$('#like').on('click', function() {
			$.ajax({
				url: '/boards/<%= @board.id %>/like',
				method: 'POST'
			});

			if(this.classList.contains('btn-info')) {
				$('#like-count').text(parseInt($('#like-count').html())+1);
			} else {
				$('#like-count').text(parseInt($('#like-count').html())-1);
			}
			$(this).toggleClass('btn-danger').toggleClass('btn-info');
		});
	})

	$('#comment-form').on('submit', function(event) {
		event.preventDefault();
		console.log("댓글달기 버튼 눌림");

		var c = $('#comment').val();
		console.log(c)

		$.ajax({
			url: "/boards/<%=@board.id%>/create_comment",
			method: 'POST',
			data: {
				contents: c
			}
		});
	})

</script>